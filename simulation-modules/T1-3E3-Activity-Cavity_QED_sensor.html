
<!DOCTYPE html>

<html data-content_root="../" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Activity 1: Solid State Spis – Cavity QED Digital Twin — 6.2410 -- Laboratory for Quantum Information Science and Engineering</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
<!--
    this give us a css class that will be invisible only if js is disabled
  -->
<noscript>
<style>
      .pst-js-only { display: none !important; }

    </style>
</noscript>
<!-- Loaded before other Sphinx assets -->
<link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet"/>
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet"/>
<link href="../_static/pygments.css?v=03e43079" rel="stylesheet" type="text/css"/>
<link href="../_static/styles/sphinx-book-theme.css?v=a3416100" rel="stylesheet" type="text/css"/>
<link href="../_static/togglebutton.css?v=13237357" rel="stylesheet" type="text/css"/>
<link href="../_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" rel="stylesheet" type="text/css"/>
<link href="../_static/sphinx-thebe.css?v=4fa983c6" rel="stylesheet" type="text/css"/>
<link href="../_static/sphinx-design.min.css?v=95c83b7e" rel="stylesheet" type="text/css"/>
<!-- So that users can add custom icons -->
<script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" rel="preload"/>
<link as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" rel="preload"/>
<script src="../_static/documentation_options.js?v=9eb32ce0"></script>
<script src="../_static/doctools.js?v=9a2dae69"></script>
<script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../_static/clipboard.min.js?v=a7894cd8"></script>
<script src="../_static/copybutton.js?v=f281be69"></script>
<script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="../_static/togglebutton.js?v=4a39c7ea"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script src="../_static/design-tabs.js?v=36754332"></script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
<script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
<script>window.MathJax = {"tex": {"macros": {"ket": ["\\left|{#1}\\right\\rangle", 1], "bra": ["\\left\\langle{#1}\\right|", 1], "braket": ["\\left\\langle{#1}\\middle|{#2}\\right\\rangle", 2], "adagger": ["\\hat{a}^{\\dagger}"], "ahat": ["\\hat{a}"], "bdagger": ["\\hat{b}^{\\dagger}"], "bhat": ["\\hat{b}"], "cdagger": ["\\hat{c}^{\\dagger}"], "chat": ["\\hat{c}"], "ddagger": ["\\hat{d}^{\\dagger}"], "dhat": ["\\hat{d}"], "edagger": ["\\hat{e}^{\\dagger}"], "ehat": ["\\hat{e}"], "fdagger": ["\\hat{f}^{\\dagger}"], "fhat": ["\\hat{f}"], "gdagger": ["\\hat{g}^{\\dagger}"], "ghat": ["\\hat{g}"], "hdagger": ["\\hat{h}^{\\dagger}"], "hhat": ["\\hat{h}"], "gtwo": ["g^{(2)}"], "H": ["\\ket{H}"], "V": ["\\ket{V}"], "D": ["\\ket{D}"], "AD": ["\\ket{AD}"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>DOCUMENTATION_OPTIONS.pagename = 'simulation-modules/T1-3E3-Activity-Cavity_QED_sensor';</script>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="T1-3E3-Activity-Compuational_HOM.html" rel="next" title="Activity 2 – Two-photon (HOM) interference simulation"/>
<link href="../quNV-Jupyter/T3E3-LAB-Week2-Quantum-Sensing-with-Solid-State-Spins.html" rel="prev" title="LAB – Quantum Sensing With Solid State Spins (Week 2)"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
<meta content="" name="docsearch:version"/>
<link href="../_static/styles/chattutor.style.css" rel="stylesheet" type="text/css"/></head>
<body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode="" data-offset="180">
<div class="skip-link d-print-none" id="pst-skip-link"><a href="#main-content">Skip to main content</a></div>
<div id="pst-scroll-pixel-helper"></div>
<button class="btn rounded-pill" id="pst-back-to-top" type="button">
<i class="fa-solid fa-arrow-up"></i>Back to top</button>
<dialog id="pst-search-dialog">
<form action="../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search this book..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" name="q" placeholder="Search this book..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</dialog>
<div class="pst-async-banner-revealer d-none">
<aside aria-label="Version warning" class="d-none d-print-none" id="bd-header-version-warning"></aside>
</div>
<header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
</header>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<dialog id="pst-primary-sidebar-modal"></dialog>
<div class="bd-sidebar-primary bd-sidebar" id="pst-primary-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
</div>
<div class="sidebar-primary-items__start sidebar-primary__section">
<div class="sidebar-primary-item">
<a class="navbar-brand logo" href="../intro.html">
<img alt="6.2410 -- Laboratory for Quantum Information Science and Engineering - Home" class="logo__image only-light" src="../_static/logo-ibm.jpg"/>
<img alt="6.2410 -- Laboratory for Quantum Information Science and Engineering - Home" class="logo__image only-dark pst-js-only" src="../_static/logo-ibm.jpg"/>
</a></div>
<div class="sidebar-primary-item">
<button aria-label="Search" class="btn search-button-field search-button__button pst-js-only" data-bs-placement="bottom" data-bs-toggle="tooltip" title="Search">
<i class="fa-solid fa-magnifying-glass"></i>
<span class="search-button__default-text">Search</span>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
<div class="sidebar-primary-item"><nav aria-label="Main" class="bd-links bd-docs-nav">
<div class="bd-toc-item navbar-nav active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="../intro.html">
                    6.2410 – Laboratory in Quantum Systems Engineering: Quantum Engineering Platforms
                </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introductory Material</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../BASICS-quantum-optics-basics.html">BASICS – Quantum Optics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">T3E1 -- Interference, Entanglement, Quantum-Enhanced Sensing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../T3E1-TEXT--entanglement-interference-quantum-enhanced-sensing.html">TEXT – Interference, Entanglement and Quantum-Enhanced Metrology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../T3E1-LAB--entanglement-interference-quantum-enhanced-sensing.html">LAB – Interference, Entanglement and Quantum-Enhanced Metrology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../T3E1-EXTRAS-interference-2-homodyne-detection.html">EXTRAS – Homodyne Detection</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">T2E1 -- Quantum Information and Quantum Key Distribution</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../T2E1-TEXT-HBT.html">TEXT - Introduction to single photons with the quED (Week 1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../T2E1-LAB-HBT.html">LAB – Hanbury Brown - Twiss Lab (Week 1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../T2E1-TEXT-QKD.html">TEXT – QKD (Week 2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../T2E1-LAB-BB84.html">LAB – QKD (Week 2)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">T3E3 -- Solid State Spins</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../quNV-Jupyter/T3E3-PARKOUR-Quantum-Sensing-with-Solid-State-Spins.html">TRAINING - Interfacing with the Vector Network Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quNV-Jupyter/T3E3-TEXT-Quantum-Sensing-with-Solid-State-Spins.html">TEXT: Introduction to NV centers in diamond and cavity-based magnetometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quNV-Jupyter/T3E3-LAB-Week1-Quantum-Sensing-with-Solid-State-Spins.html">LAB - Quantum Sensing with Solid State Spins (Week 1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quNV-Jupyter/T3E3-LAB-Week2-Quantum-Sensing-with-Solid-State-Spins.html">LAB – Quantum Sensing With Solid State Spins (Week 2)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">T1:3E2 -- Quantum Simulation Lab</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Activity 1: Solid State Spis – Cavity QED Digital Twin</a></li>
<li class="toctree-l1"><a class="reference internal" href="T1-3E3-Activity-Compuational_HOM.html">Activity 2 – Two-photon (HOM) interference simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="T1_3E2_spdc_simulation_by_qutip.html">Activity 3: SPDC Simulation by QuTip</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Final Projects</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../FINAL-PROJECTS.html">Final Design Project</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Templates</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../TEMPLATES/TEMPLATE-6.2410-summary-report.html">Summary Report Template</a></li>
</ul>
</div>
</nav></div>
</div>
<div class="sidebar-primary-items__end sidebar-primary__section">
<div class="sidebar-primary-item">
<div class="flat" data-ea-manual="true" data-ea-publisher="readthedocs" data-ea-type="readthedocs-sidebar" id="ethical-ad-placement">
</div></div>
</div>
</div>
<main class="bd-main" id="main-content" role="main">
<div class="sbt-scroll-pixel-helper"></div>
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
<div class="header-article-items__start">
<div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" data-bs-placement="bottom" data-bs-toggle="tooltip" title="Toggle primary sidebar">
<span class="fa-solid fa-bars"></span>
</button></div>
</div>
<div class="header-article-items__end">
<div class="header-article-item">
<div class="article-header-buttons">
<div class="dropdown dropdown-launch-buttons">
<button aria-expanded="false" aria-label="Launch interactive content" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fas fa-rocket"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="https://mybinder.org/v2/gh/dkeathley/S23-6.2410-lab/main?urlpath=tree/simulation-modules/T1-3E3-Activity-Cavity_QED_sensor.ipynb" target="_blank" title="Launch on Binder">
<span class="btn__icon-container">
<img alt="Binder logo" src="../_static/images/logo_binder.svg"/>
</span>
<span class="btn__text-container">Binder</span>
</a>
</li>
<li><a class="btn btn-sm dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="https://colab.research.google.com/github/dkeathley/S23-6.2410-lab/blob/main/simulation-modules/T1-3E3-Activity-Cavity_QED_sensor.ipynb" target="_blank" title="Launch on Colab">
<span class="btn__icon-container">
<img alt="Colab logo" src="../_static/images/logo_colab.png"/>
</span>
<span class="btn__text-container">Colab</span>
</a>
</li>
</ul>
</div>
<div class="dropdown dropdown-source-buttons">
<button aria-expanded="false" aria-label="Source repositories" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fab fa-github"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm btn-source-repository-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="https://github.com/dkeathley/S23-6.2410-lab" target="_blank" title="Source repository">
<span class="btn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="btn__text-container">Repository</span>
</a>
</li>
<li><a class="btn btn-sm btn-source-issues-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="https://github.com/dkeathley/S23-6.2410-lab/issues/new?title=Issue%20on%20page%20%2Fsimulation-modules/T1-3E3-Activity-Cavity_QED_sensor.html&amp;body=Your%20issue%20content%20here." target="_blank" title="Open an issue">
<span class="btn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
</ul>
</div>
<div class="dropdown dropdown-download-buttons">
<button aria-expanded="false" aria-label="Download this page" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fas fa-download"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm btn-download-source-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="../_sources/simulation-modules/T1-3E3-Activity-Cavity_QED_sensor.ipynb" target="_blank" title="Download source file">
<span class="btn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
<li>
<button class="btn btn-sm btn-download-pdf-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" onclick="window.print()" title="Print to PDF">
<span class="btn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
<button class="btn btn-sm btn-fullscreen-button" data-bs-placement="bottom" data-bs-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="btn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<button aria-label="Color mode" class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" data-bs-placement="bottom" data-bs-title="Color mode" data-bs-toggle="tooltip">
<i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light" title="Light"></i>
<i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark" title="Dark"></i>
<i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto" title="System Settings"></i>
</button>
<button aria-label="Search" class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" data-bs-placement="bottom" data-bs-toggle="tooltip" title="Search">
<i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" data-bs-placement="bottom" data-bs-toggle="tooltip" title="Toggle secondary sidebar">
<span class="fa-solid fa-list"></span>
</button>
</div></div>
</div>
</div>
</div>
<div class="onlyprint" id="jb-print-docs-body">
<h1>Activity 1: Solid State Spis – Cavity QED Digital Twin</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prelab">Prelab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cavity-coupled-quantum-electrodynamic-qed-sensor">Cavity-coupled quantum electrodynamic (QED) sensor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regime">Linear Regime</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nonlinear-regime">Nonlinear Regime</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimum-detectable-magnetic-field">Minimum detectable magnetic field</a></li>
</ul>
</nav>
</div>
</div>
</div>
<div id="searchbox"></div>
<article class="bd-article">
<section class="tex2jax_ignore mathjax_ignore" id="activity-1-solid-state-spis-cavity-qed-digital-twin">
<h1>Activity 1: Solid State Spis – Cavity QED Digital Twin<a class="headerlink" href="#activity-1-solid-state-spis-cavity-qed-digital-twin" title="Link to this heading">#</a></h1>
<section id="prelab">
<h2>Prelab<a class="headerlink" href="#prelab" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Setup <a class="reference external" href="https://qutip.org/">QuTiP</a> to run on a cloud service like Google Colab or install it on your own PC.</p></li>
<li><p>Go through and perform the activities in <a class="reference external" href="https://qutip.org/qutip-tutorials/">QuTiP Lecture 0</a>.</p></li>
<li><p>Read the background text for the <a class="reference internal" href="../quNV-Jupyter/T3E3-TEXT-Quantum-Sensing-with-Solid-State-Spins.html#chapter-nv-centers"><span class="std std-ref">NV Center Lab</span></a> to understand the basics of the experimental setup.</p></li>
</ol>
</section>
<section id="cavity-coupled-quantum-electrodynamic-qed-sensor">
<h2>Cavity-coupled quantum electrodynamic (QED) sensor<a class="headerlink" href="#cavity-coupled-quantum-electrodynamic-qed-sensor" title="Link to this heading">#</a></h2>
<p>Hanfeng Wang, Matthew E. Trusheim, and Dirk Englund</p>
<p>Resonators for electromagnetic fields in the range of 1-100 GHz are essential in a range of quantum technologies, including superconducting quantum computers, microwave-optical quantum information interfaces, as well as sensors. Here, we consider microwave cavities coupled to ensembles of electron and nuclear spins associated with nitrogen vacancy (NV) centers in diamond. Following the discovery of coherent quantum dynamics of NV centers in the late 1990s, NV centers have emerged as leading quantum sensors for quantities ranging from electromagnetic fields to temperature, strain, rotation (gyroscopes), and have even been proposed for exotic schemes like dark matter detection. The key advantages of NV centers in sensing applications, over other electron spin systems, are their long coherence times and avaible optical polarization at room temperature.</p>
<p>Suggested reading for this laboratory on hybrid systems of microwave cavities coupled to NV spin ensembles specifically:
– 1 ) <a class="reference external" href="https://www.nature.com/articles/s41467-021-21256-7">E. Eisenach et al, Cavity-enhanced microwave readout of a solid-state spin sensor</a></p>
<p>– [optional] <a class="reference external" href="https://https://journals.aps.org/rmp/abstract/10.1103/RevModPhys.92.015004">JF Barry et. al. Sensitivity optimization for NV-diamond magnetometry</a></p>
<p>– [optional] <a class="reference external" href="https://https://arxiv.org/abs/2203.03462"> D. Fahey et. al., Steady-state microwave mode cooling with a diamond NV ensemble</a></p>
<p>– <a class="reference external" href="https://arxiv.org/abs/2009.02427">ME Trusheim et. al. A Polariton-Stabilized Spin Clock
</a></p>
<p>Upon optical excitation, nonradiative decay through a spin-state-dependent intersystem crossing produces spin-state-dependent fluorescence contrast and polarize NV spin to m_s = 0 ground state. A common way for NV spin readout relies on detecting this spin-state-dependent fluorescence. However, due to the low photon detection efficiency (C~0.015) for NV ensemble, the NV magnetic sensitivity is limited by the photon-shot-noise-limit.</p>
<p>One way to solve this problem is to use NV-cavity coupling, where we couple NV centers to another system (cavity in this case) and read the NV resonance frequency by via the cavity mode.</p>
<p>In this module, you will learn how to simulate this system in QuTiP.</p>
<figure class="align-default" id="cavity-qed-setup">
<a class="bg-primary mb-1 reference internal image-reference" href="../_images/nv-center-cavity-qed-setup.png"><img alt="Experimental Setup" class="bg-primary mb-1" src="../_images/nv-center-cavity-qed-setup.png" style="width: 800px;"/></a>
<figcaption>
<p><span class="caption-number">Fig. 65 </span><span class="caption-text">Experimental setup for studying quantum spins.</span><a class="headerlink" href="#cavity-qed-setup" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="linear-regime">
<h2>Linear Regime<a class="headerlink" href="#linear-regime" title="Link to this heading">#</a></h2>
<p>Consider a case where we have a two-level system, such as a Nitrogen-Vacancy (NV) center, and an excitation, for example, a cavity mode. These two systems interact with each other when their frequencies are resonant. In the spectrum, we observe the phenomenon known as anti-crossing or avoided-crossing effect, which occurs when the energy levels of the two systems approach each other closely but do not actually cross.</p>
<p>From <a class="reference external" href="https://en.wikipedia.org/wiki/Avoided_crossing">Wikipedia</a>: In quantum physics and quantum chemistry, an avoided crossing (sometimes called intended crossing, non-crossing or anticrossing) is the phenomenon where two eigenvalues of a Hermitian matrix representing a quantum observable and depending on N continuous real parameters cannot become equal in value (“cross”) except on a manifold of N-3 dimensions.</p>
<figure class="align-default" id="avoided-crossing">
<a class="bg-primary mb-1 reference internal image-reference" href="../_images/adiabatic-states-linear-field.png"><img alt="avoided crossing" class="bg-primary mb-1" src="../_images/adiabatic-states-linear-field.png" style="width: 800px;"/></a>
<figcaption>
<p><span class="caption-number">Fig. 66 </span><span class="caption-text">Avoided crossing of <span class="math notranslate nohighlight">\(\ket{\phi_1}\)</span> and <span class="math notranslate nohighlight">\(\ket{\phi_2}\)</span></span><a class="headerlink" href="#avoided-crossing" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>This is the simplest case where we did not add the information about two-level system and the cavity mode. For example, the two-level system should have linewidth and cavity mode should have inherent loss. The question now is: how we paramitrize the system with those real conditions?</p>
<p>The next code set is a good example to set it up. For details please refer to Erik’s paper in the prelab.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ipywidgets</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">widgets</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ipywidgets</span><span class="w"> </span><span class="kn">import</span> <span class="n">HBox</span><span class="p">,</span> <span class="n">VBox</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact_manual</span><span class="p">(</span>
    <span class="n">g0_in</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">1.</span><span class="p">),</span><span class="n">kc0_in</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">),</span><span class="n">kc1_in</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">),</span><span class="n">ks_in</span><span class="o">=</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">runFunc</span><span class="p">(</span><span class="n">g0_in</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">kc0_in</span> <span class="o">=</span> <span class="mi">70</span><span class="p">,</span> <span class="n">kc1_in</span> <span class="o">=</span> <span class="mi">111</span><span class="p">,</span> <span class="n">ks_in</span> <span class="o">=</span> <span class="mi">308</span><span class="p">):</span>
    <span class="n">kc0</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">kc0_in</span><span class="p">;</span> <span class="c1">#kHz  Cavity linewidth</span>
    <span class="n">kc1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">kc1_in</span><span class="p">;</span> <span class="c1">#kHz   Cavity-loop coupling (output coupling)</span>

    <span class="n">ks</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">ks_in</span><span class="p">;</span> <span class="c1">#kHz  Spin coherence time</span>


    <span class="n">density_NVs</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="c1">#PPM Density of NV centers in the diamond, given in ppm</span>
    <span class="n">diamondDensity</span> <span class="o">=</span> <span class="mf">1.76e29</span><span class="p">;</span> <span class="c1"># atoms/m^3 Atomic density of diamond</span>
    <span class="n">density_NVs_SI</span> <span class="o">=</span> <span class="n">density_NVs</span><span class="o">*</span><span class="mf">1e-6</span><span class="o">*</span><span class="n">diamondDensity</span><span class="p">;</span> <span class="c1"># NV/m^3</span>

    <span class="n">diamond_sample_dim_x</span><span class="o">=</span><span class="mf">3e-3</span><span class="p">;</span> <span class="c1"># m Diamond spatial dimensions, assuming cuboid</span>
    <span class="n">diamond_sample_dim_y</span><span class="o">=</span><span class="mf">3e-3</span><span class="p">;</span> <span class="c1"># m</span>
    <span class="n">diamond_sample_dim_z</span><span class="o">=</span><span class="mf">0.5e-3</span><span class="p">;</span> <span class="c1"># m</span>
    <span class="n">diamond_sample_volume</span> <span class="o">=</span> <span class="n">diamond_sample_dim_x</span><span class="o">*</span><span class="n">diamond_sample_dim_y</span><span class="o">*</span><span class="n">diamond_sample_dim_z</span><span class="p">;</span>

    <span class="n">N_NVs</span><span class="o">=</span> <span class="n">density_NVs_SI</span><span class="o">*</span><span class="n">diamond_sample_volume</span> <span class="p">;</span> <span class="c1"># the number of NVs in the diamond</span>

    <span class="n">g0</span> <span class="o">=</span> <span class="n">g0_in</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">;</span> <span class="c1">#kHz   Coupling strength for single spin, see referenced papers</span>

    <span class="n">geff</span> <span class="o">=</span> <span class="n">g0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N_NVs</span><span class="p">);</span> <span class="c1"># Total coupling scales as sqrt(N)</span>


    <span class="n">kc</span> <span class="o">=</span> <span class="n">kc0</span> <span class="o">+</span> <span class="n">kc1</span><span class="p">;</span> <span class="c1"># Total cavity loss</span>

    <span class="n">xnum</span> <span class="o">=</span> <span class="mi">101</span><span class="p">;</span> <span class="c1"># number of points to plot in x</span>
    <span class="n">ynum</span> <span class="o">=</span> <span class="mi">121</span><span class="p">;</span>

    <span class="c1"># initialize sweep parameters</span>
    <span class="n">wdc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">xnum</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">;</span>  <span class="c1">#kHz  Detuning of the probe frequency and cavity frequency</span>
    <span class="n">wsc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">7.4</span><span class="p">,</span><span class="mf">7.4</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">ynum</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">;</span>  <span class="c1">#kHz  Detuning of the spin frequency and cavity frequency</span>

    <span class="c1"># initialize output ararys</span>
    <span class="n">inphaseOut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xnum</span><span class="p">,</span><span class="n">ynum</span><span class="p">));</span>
    <span class="n">quadratureOut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xnum</span><span class="p">,</span><span class="n">ynum</span><span class="p">));</span>

    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xnum</span><span class="p">):</span>

      <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ynum</span><span class="p">):</span>

        <span class="n">wds</span> <span class="o">=</span> <span class="n">wdc</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">-</span><span class="n">wsc</span><span class="p">[</span><span class="n">jj</span><span class="p">];</span> <span class="c1">#drive-spin detuning</span>

        <span class="c1"># Cavity reflection signal from references</span>
        <span class="n">refOutput</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">kc1</span><span class="o">/</span><span class="p">(</span><span class="n">kc</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">wdc</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="n">geff</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ks</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">wds</span><span class="p">));</span>
        <span class="n">inphaseOut</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">refOutput</span><span class="p">);</span> <span class="c1"># In-phase part of the cavity signal</span>
        <span class="n">quadratureOut</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">refOutput</span><span class="p">);</span>  <span class="c1"># Quadrature part of the cavity signal</span>

    <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">7.4</span><span class="p">,</span><span class="mf">7.4</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">ynum</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">xnum</span><span class="p">),)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">figAxes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sharex</span><span class="o">=</span><span class="s1">'all'</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">'all'</span><span class="p">)</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">figAxes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">figAxes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span>
    <span class="n">ax3</span> <span class="o">=</span> <span class="n">figAxes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">];</span>
    <span class="n">ax4</span> <span class="o">=</span> <span class="n">figAxes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span>


    <span class="n">c</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">quadratureOut</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Q$ = \text</span><span class="si">{Im}</span><span class="s1">[\Gamma]$'</span><span class="p">)</span>
    <span class="c1">#ax1.set_xlabel('fsc (MHz)')</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'fdc (MHz)'</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">inphaseOut</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'I$ = \text</span><span class="si">{Re}</span><span class="s1">[\Gamma]$'</span><span class="p">)</span>
    <span class="c1">#ax2.set_xlabel('fsc (MHz)')</span>
    <span class="c1">#ax2.set_ylabel('fdc (MHz)')</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">quadratureOut</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="n">inphaseOut</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'P$ = |\Gamma|$'</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'fsc (MHz)'</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'fdc (MHz)'</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">)</span>

    <span class="n">c</span> <span class="o">=</span> <span class="n">ax4</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">quadratureOut</span><span class="p">,</span><span class="n">inphaseOut</span><span class="p">)))</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\phi = \arg(\Gamma)$'</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'fsc (MHz)'</span><span class="p">)</span>
    <span class="c1">#ax4.set_ylabel('fdc (MHz)')</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax4</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span><span class="w"> </span><span class="nn">ipywidgets</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">widgets</span>

<span class="ne">ModuleNotFoundError</span>: No module named 'numpy'
</pre></div>
</div>
</div>
</div>
</section>
<section id="nonlinear-regime">
<h2>Nonlinear Regime<a class="headerlink" href="#nonlinear-regime" title="Link to this heading">#</a></h2>
<p>Now, we have a good understanding of the anti-crossing feature in NV-cavity coupling. However, this knowledge alone is not sufficient. Let’s delve deeper into the issue.</p>
<p>In the schematic of the setup, there are actually three components: the NV center, the cavity mode, and an antenna designed to detect the cavity mode. It is crucial to couple the antenna with the cavity mode to facilitate detection. This raises a question:</p>
<p>Why can’t the antenna couple with the NV system directly?</p>
<p>The answer is that it indeed can couple with the NV system, but only when the input power to the antenna is sufficiently high. Consequently, we are dealing with a tripartite system. To analyze this system, we employ a semiclassical model to solve the Maxwell-Bloch equations for the hybrid system.</p>
<p>Here we do not expand the details for the derivation about the Maxwell-Bloch equations because it is too complicated and beyond the scope of our course. If you are really interested in the whole process, please ask the TA.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Constants and Parameters</span>
<span class="n">Gamma</span> <span class="o">=</span> <span class="mf">330e3</span>  <span class="c1"># Inhomogeneous linewidth</span>
<span class="n">gammao</span> <span class="o">=</span> <span class="mf">33e3</span>  <span class="c1"># Optical polarization rate</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">2e3</span>    <span class="c1"># Homogeneous linewidth</span>

<span class="n">kc1</span> <span class="o">=</span> <span class="mf">130e3</span> <span class="c1"># Intrinsic cavity linewidth</span>
<span class="n">kc</span> <span class="o">=</span> <span class="n">kc1</span> <span class="o">+</span> <span class="mf">130e3</span>  <span class="c1"># Total cavity linewidth</span>
<span class="n">gs</span> <span class="o">=</span> <span class="mf">0.019</span> <span class="c1"># Single spin coupling strength</span>
<span class="n">Power</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>  <span class="c1"># Input MW power</span>
<span class="n">alpha2</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">Power</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-3</span> <span class="o">/</span> <span class="p">(</span><span class="mf">6.626e-34</span> <span class="o">*</span> <span class="mf">2.87e9</span> <span class="o">*</span> <span class="n">kc1</span><span class="p">)</span>

<span class="n">geff</span> <span class="o">=</span> <span class="mf">0.2e6</span>  <span class="c1"># Total coupling strength</span>

<span class="n">omega</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">wdc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e6</span>
<span class="n">wsc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">4.65</span><span class="p">,</span> <span class="mf">4.65</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e6</span>

<span class="c1"># Initialize array for results</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">wdc</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">wsc</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

<span class="c1"># Main calculation loop</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wdc</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wsc</span><span class="p">)):</span>
        <span class="n">wds</span> <span class="o">=</span> <span class="n">wdc</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">-</span> <span class="n">wsc</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span>
        <span class="n">integ1</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">gamma</span> <span class="o">+</span> <span class="n">gammao</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">+</span> <span class="n">gammao</span><span class="p">)</span> <span class="o">*</span> <span class="n">Gamma</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">gs</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">alpha2</span> <span class="o">/</span> <span class="n">gammao</span> <span class="o">*</span> <span class="p">(</span><span class="n">gammao</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">gammao</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="n">j</span> <span class="o">*</span> <span class="n">wds</span><span class="p">)</span> <span class="o">/</span> \
                <span class="p">((</span><span class="n">Gamma</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">gs</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">alpha2</span> <span class="o">/</span> <span class="n">gammao</span> <span class="o">*</span> <span class="p">(</span><span class="n">gammao</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">gammao</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">wds</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">integ2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">gamma</span> <span class="o">+</span> <span class="n">gammao</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">+</span> <span class="n">gammao</span><span class="p">)</span> <span class="o">*</span> <span class="n">Gamma</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">gs</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">alpha2</span> <span class="o">/</span> <span class="n">gammao</span> <span class="o">*</span> <span class="p">(</span><span class="n">gammao</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">gammao</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">wds</span> <span class="o">+</span> <span class="mf">2.1e6</span><span class="p">))</span> <span class="o">/</span> \
                <span class="p">((</span><span class="n">Gamma</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">gs</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">alpha2</span> <span class="o">/</span> <span class="n">gammao</span> <span class="o">*</span> <span class="p">(</span><span class="n">gammao</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">gammao</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">wds</span> <span class="o">+</span> <span class="mf">2.1e6</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">integ3</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">gamma</span> <span class="o">+</span> <span class="n">gammao</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">gamma</span> <span class="o">+</span> <span class="n">gammao</span><span class="p">)</span> <span class="o">*</span> <span class="n">Gamma</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">gs</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">alpha2</span> <span class="o">/</span> <span class="n">gammao</span> <span class="o">*</span> <span class="p">(</span><span class="n">gammao</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">gammao</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">wds</span> <span class="o">-</span> <span class="mf">2.1e6</span><span class="p">))</span> <span class="o">/</span> \
                <span class="p">((</span><span class="n">Gamma</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">gs</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">alpha2</span> <span class="o">/</span> <span class="n">gammao</span> <span class="o">*</span> <span class="p">(</span><span class="n">gammao</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">gammao</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">wds</span> <span class="o">-</span> <span class="mf">2.1e6</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">integ</span> <span class="o">=</span> <span class="n">integ1</span> <span class="o">+</span> <span class="n">integ2</span> <span class="o">+</span> <span class="n">integ3</span>
        <span class="n">ref</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">kc1</span> <span class="o">/</span> <span class="p">(</span><span class="n">kc</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">wdc</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">+</span> <span class="n">geff</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">integ</span><span class="p">)</span>

<span class="c1"># Plotting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">wsc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">wsc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">wdc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">wdc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1e6</span><span class="p">],</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">'lower'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$(\omega_s-\omega_c)/(2\pi)$ (MHz)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$(\omega_d-\omega_c)/(2\pi)$ (MHz)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$|\Gamma|^2$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2aa0b52fbf3fd009ef95cdaa7f624596e0864755ce0ad4a80fcf2d91541e95ea.png" src="../_images/2aa0b52fbf3fd009ef95cdaa7f624596e0864755ce0ad4a80fcf2d91541e95ea.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">length</span> <span class="o">=</span> <span class="mi">2000000</span>  <span class="c1"># Length of the signal</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mf">200e3</span>      <span class="c1"># Sampling frequency in Hz</span>

<span class="n">white_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">length</span><span class="p">)</span><span class="o">*</span><span class="mf">1e-6</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">length</span><span class="p">)</span> <span class="o">/</span> <span class="n">fs</span>
<span class="n">sine_wave</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">sine_wave</span> <span class="o">=</span> <span class="n">sine_wave</span> <span class="o">+</span> <span class="mf">1e-7</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">t</span> <span class="o">*</span> <span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">**</span><span class="n">ii</span>
<span class="c1">#    sine_wave = 1e-7* np.sin(2 * np.pi * 60 * t) +  0.5e-7* np.sin(2 * np.pi * 120 * t) +  0.25e-7* np.sin(2 * np.pi * 180 * t);</span>

<span class="n">fft_result1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">white_noise</span><span class="o">+</span><span class="n">sine_wave</span><span class="p">)</span>

<span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
<span class="n">frequencies</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-6</span>  <span class="c1"># Avoid division by zero</span>

<span class="n">scale_factor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">frequencies</span><span class="p">))</span>
<span class="n">fft_result2</span> <span class="o">=</span> <span class="n">scale_factor</span>

<span class="n">modified_fft</span> <span class="o">=</span> <span class="p">(</span><span class="n">fft_result1</span> <span class="o">+</span> <span class="n">fft_result2</span><span class="o">*</span><span class="mf">1e-1</span><span class="p">);</span>

<span class="n">flicker_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">modified_fft</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>

<span class="n">final</span> <span class="o">=</span> <span class="n">flicker_noise</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">flicker_noise</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">final</span><span class="p">[</span><span class="mi">10000</span><span class="p">:</span><span class="mi">2000000</span><span class="o">-</span><span class="mi">10000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Noise'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Sample'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Voltage (V)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e9aaca7597ea70bb9f3ee8d390e2919875187903b6b38dab73dd5116a794301f.png" src="../_images/e9aaca7597ea70bb9f3ee8d390e2919875187903b6b38dab73dd5116a794301f.png"/>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.signal</span><span class="w"> </span><span class="kn">import</span> <span class="n">periodogram</span>
<span class="n">frequencies</span><span class="p">,</span> <span class="n">psd</span> <span class="o">=</span> <span class="n">periodogram</span><span class="p">(</span><span class="n">final</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">psd</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s2">"log"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">"log"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">1e-11</span><span class="p">,</span><span class="mf">1e-5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">1e1</span><span class="p">,</span><span class="mf">1e5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Noise by frequency'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Frequency'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Amplitude'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, 'Amplitude')
</pre></div>
</div>
<img alt="../_images/58b72e1b247a377c4a29b4a1b1556045cf38185f8eb921e86298c766af0f215f.png" src="../_images/58b72e1b247a377c4a29b4a1b1556045cf38185f8eb921e86298c766af0f215f.png"/>
</div>
</div>
</section>
<section id="exercise-1">
<h2>Exercise 1:<a class="headerlink" href="#exercise-1" title="Link to this heading">#</a></h2>
<p>Now we have the signal and noise model. We provide a perfect plot of the signal below. Please generate one with the noise incorporated and plot it below the perfect signal for comparison.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Part 1</span>
<span class="c1"># Let's consider a 1D plot first.</span>

<span class="n">g0_in</span><span class="o">=</span><span class="mf">0.01</span>
<span class="n">kc0_in</span> <span class="o">=</span> <span class="mi">70</span>
<span class="n">kc1_in</span> <span class="o">=</span> <span class="mi">111</span>
<span class="n">ks_in</span> <span class="o">=</span> <span class="mi">308</span>
<span class="n">kc0</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">kc0_in</span><span class="p">;</span> <span class="c1">#kHz  Cavity linewidth</span>
<span class="n">kc1</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">kc1_in</span><span class="p">;</span> <span class="c1">#kHz   Cavity-loop coupling (output coupling)</span>

<span class="n">ks</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">ks_in</span><span class="p">;</span> <span class="c1">#kHz  Spin coherence time</span>

<span class="n">density_NVs</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="c1">#PPM Density of NV centers in the diamond, given in ppm</span>
<span class="n">diamondDensity</span> <span class="o">=</span> <span class="mf">1.76e29</span><span class="p">;</span> <span class="c1"># atoms/m^3 Atomic density of diamond</span>
<span class="n">density_NVs_SI</span> <span class="o">=</span> <span class="n">density_NVs</span><span class="o">*</span><span class="mf">1e-6</span><span class="o">*</span><span class="n">diamondDensity</span><span class="p">;</span> <span class="c1"># NV/m^3</span>

<span class="n">diamond_sample_dim_x</span><span class="o">=</span><span class="mf">3e-3</span><span class="p">;</span> <span class="c1"># m Diamond spatial dimensions, assuming cuboid</span>
<span class="n">diamond_sample_dim_y</span><span class="o">=</span><span class="mf">3e-3</span><span class="p">;</span> <span class="c1"># m</span>
<span class="n">diamond_sample_dim_z</span><span class="o">=</span><span class="mf">0.5e-3</span><span class="p">;</span> <span class="c1"># m</span>
<span class="n">diamond_sample_volume</span> <span class="o">=</span> <span class="n">diamond_sample_dim_x</span><span class="o">*</span><span class="n">diamond_sample_dim_y</span><span class="o">*</span><span class="n">diamond_sample_dim_z</span><span class="p">;</span>

<span class="n">N_NVs</span><span class="o">=</span> <span class="n">density_NVs_SI</span><span class="o">*</span><span class="n">diamond_sample_volume</span> <span class="p">;</span> <span class="c1"># the number of NVs in the diamond</span>

<span class="n">g0</span> <span class="o">=</span> <span class="n">g0_in</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">;</span> <span class="c1">#kHz   Coupling strength for single spin, see referenced papers</span>

<span class="n">geff</span> <span class="o">=</span> <span class="n">g0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">N_NVs</span><span class="p">);</span> <span class="c1"># Total coupling scales as sqrt(N)</span>


<span class="n">kc</span> <span class="o">=</span> <span class="n">kc0</span> <span class="o">+</span> <span class="n">kc1</span><span class="p">;</span> <span class="c1"># Total cavity loss</span>

<span class="n">xnum</span> <span class="o">=</span> <span class="mi">501</span><span class="p">;</span> <span class="c1"># number of points to plot in x</span>
<span class="n">ynum</span> <span class="o">=</span> <span class="mi">501</span><span class="p">;</span>

<span class="c1"># initialize sweep parameters</span>
<span class="n">wdc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">xnum</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">;</span>  <span class="c1">#kHz  Detuning of the probe frequency and cavity frequency</span>
<span class="n">wsc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">7.4</span><span class="p">,</span><span class="mf">7.4</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">ynum</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">;</span>  <span class="c1">#kHz  Detuning of the spin frequency and cavity frequency</span>

<span class="c1"># initialize output ararys</span>
<span class="n">inphaseOut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xnum</span><span class="p">,</span><span class="n">ynum</span><span class="p">));</span>
<span class="n">quadratureOut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">xnum</span><span class="p">,</span><span class="n">ynum</span><span class="p">));</span>

<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xnum</span><span class="p">):</span>

  <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ynum</span><span class="p">):</span>

    <span class="n">wds</span> <span class="o">=</span> <span class="n">wdc</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">-</span><span class="n">wsc</span><span class="p">[</span><span class="n">jj</span><span class="p">];</span> <span class="c1">#spin-cavity detuning</span>

    <span class="c1"># Cavity reflection signal from references</span>
    <span class="n">refOutput</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">kc1</span><span class="o">/</span><span class="p">(</span><span class="n">kc</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">wdc</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">+</span><span class="nb">pow</span><span class="p">(</span><span class="n">geff</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ks</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">wds</span><span class="p">));</span>
    <span class="n">inphaseOut</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">refOutput</span><span class="p">);</span> <span class="c1"># In-phase part of the cavity signal</span>
    <span class="n">quadratureOut</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="n">jj</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">refOutput</span><span class="p">);</span>  <span class="c1"># Quadrature part of the cavity signal</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wsc</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="n">inphaseOut</span><span class="p">[</span><span class="mi">251</span><span class="p">][:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\omega_</span><span class="si">{d}</span><span class="s1"> = \omega_</span><span class="si">{c}</span><span class="s1">$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Spin-cavity frequency detuning $\omega_</span><span class="si">{s}</span><span class="s1"> - \omega_</span><span class="si">{c}</span><span class="s1">$ (MHz)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'In-phase component of $\Gamma$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1"># Part 2</span>
<span class="c1"># Now you have a perfect signal, could you add noise here?</span>
<span class="c1">## Please add your code here</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, 'In-phase component of $\\Gamma$')
</pre></div>
</div>
<img alt="../_images/d6461070d8bac2b5196ff121aaf10fc6907a92adb4e9152de01a45ecfee81f8a.png" src="../_images/d6461070d8bac2b5196ff121aaf10fc6907a92adb4e9152de01a45ecfee81f8a.png"/>
</div>
</div>
</section>
<section id="exercise-2">
<h2>Exercise 2:<a class="headerlink" href="#exercise-2" title="Link to this heading">#</a></h2>
<p>Now assume we have a test field <span class="math notranslate nohighlight">\(B_t\)</span>, could you generate a <span class="math notranslate nohighlight">\(B_t\)</span> in the digital twin? Decrease the amplitude and see what is the minimum test field <span class="math notranslate nohighlight">\(B_t\)</span> you can measure in the digital twin.</p>
<p>Hint: Look at how the quadrature component of <span class="math notranslate nohighlight">\(\Gamma\)</span> changes with magnetic field (which changes the spin frequency to be slightly different from the cavity frequency). When is this change larger than the average noise?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Add your code here</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="minimum-detectable-magnetic-field">
<h2>Minimum detectable magnetic field<a class="headerlink" href="#minimum-detectable-magnetic-field" title="Link to this heading">#</a></h2>
<p>Here is the sensitivity analysis for cavity-coupled sensor. In the ideal case, the spin-projection-limit sensitivity is propotional to the inverse of the square root of the number of spins (N). However, the NV decoherence time and dephasing time will decrease during the increase of the NV number. Therefore, the sensivitity will decrease sharply in the large-N regime. The script below calculated the spin-projection-limit sensitivity and photon-shot-noise-limit with different number of spins.</p>
<p>The script below also include the cavity-coupled spin sensor. The scale of the sensitivity in the low-N regime is linear with the 1/N rather than 1/sqrt(N), which offers the possibility for this sensor to go below the spin-projection-limit sensitivity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Delta</span> <span class="o">=</span> <span class="mf">2e6</span><span class="p">;</span>
<span class="n">f</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>

<span class="n">Sphi</span> <span class="o">=</span> <span class="mf">1e-9</span><span class="p">;</span> <span class="c1"># phase noise</span>

<span class="n">Q</span> <span class="o">=</span> <span class="mf">3e4</span><span class="p">;</span>  <span class="c1"># Quality factor</span>

<span class="n">hbar</span> <span class="o">=</span> <span class="mf">1.05e-34</span><span class="p">;</span>

<span class="n">gs</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

<span class="n">muB</span> <span class="o">=</span> <span class="mf">9.27e-24</span><span class="p">;</span>

<span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">)</span><span class="o">*</span><span class="mf">1e6</span><span class="p">;</span>

<span class="n">Tc</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">3.3e-19</span><span class="o">/</span><span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="p">(</span><span class="mf">0.95</span><span class="o">/</span><span class="mf">0.05</span><span class="p">));</span>

<span class="n">T2c</span> <span class="o">=</span> <span class="mf">300e-6</span><span class="p">;</span>

<span class="n">T2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">T2c</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">Tc</span><span class="p">);</span>

<span class="n">mu0</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">1e-7</span><span class="p">;</span>

<span class="n">C</span> <span class="o">=</span> <span class="mf">0.015</span><span class="p">;</span>

<span class="n">etaB</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="nb">pow</span><span class="p">((</span><span class="n">hbar</span><span class="o">/</span><span class="n">gs</span><span class="o">/</span><span class="n">muB</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">Delta</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="n">Q</span><span class="o">/</span><span class="n">T2</span> <span class="o">*</span> <span class="n">Sphi</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="n">mu0</span><span class="o">/</span><span class="n">hbar</span><span class="o">/</span><span class="n">rho</span> <span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">f</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="nb">pow</span><span class="p">((</span><span class="n">T2</span><span class="o">/</span><span class="n">T2c</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">T2</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span><span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">1e-6</span><span class="o">/</span><span class="n">T2</span><span class="p">);</span>

<span class="n">eta</span> <span class="o">=</span> <span class="n">hbar</span><span class="o">/</span><span class="n">muB</span><span class="o">/</span><span class="n">gs</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="nb">pow</span><span class="p">((</span><span class="n">T2</span><span class="o">/</span><span class="n">T2c</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="n">C</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">T2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">T2</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">1e-6</span><span class="o">/</span><span class="n">T2</span><span class="p">);</span>

<span class="n">eta_proj</span> <span class="o">=</span> <span class="n">hbar</span><span class="o">/</span><span class="n">muB</span><span class="o">/</span><span class="n">gs</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="nb">pow</span><span class="p">((</span><span class="n">T2</span><span class="o">/</span><span class="n">T2c</span><span class="p">),</span><span class="mi">3</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">rho</span><span class="o">*</span><span class="n">T2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">T2</span><span class="o">/</span><span class="n">Tc</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">1e-6</span><span class="o">/</span><span class="n">T2</span><span class="p">);</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span><span class="n">eta</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3e-3</span><span class="o">*</span><span class="mf">3e-3</span><span class="o">*</span><span class="mf">0.5e-3</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s1">'Photon shot noise limit'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span><span class="n">eta_proj</span><span class="o">*</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3e-3</span><span class="o">*</span><span class="mf">3e-3</span><span class="o">*</span><span class="mf">0.5e-3</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s1">'Spin projection limit'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">rho</span><span class="o">/</span><span class="mf">1e6</span><span class="p">,</span><span class="n">etaB</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">'Cavity readout sensitivity'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'NV Density (cm$^{-3}$)'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Sensitivity (T/$\sqrt</span><span class="si">{Hz}</span><span class="s1">$)'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, 'Sensitivity (T/$\\sqrt{Hz}$)')
</pre></div>
</div>
<img alt="../_images/fff1e7ecee8fb100c366d17e8fa129e71d8214d36bf59a83049beecd9c80974e.png" src="../_images/fff1e7ecee8fb100c366d17e8fa129e71d8214d36bf59a83049beecd9c80974e.png"/>
</div>
</div>
</section>
</section>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./simulation-modules"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</article>
<footer class="prev-next-footer d-print-none">
<div class="prev-next-area">
<a class="left-prev" href="../quNV-Jupyter/T3E3-LAB-Week2-Quantum-Sensing-with-Solid-State-Spins.html" title="previous page">
<i class="fa-solid fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">LAB – Quantum Sensing With Solid State Spins (Week 2)</p>
</div>
</a>
<a class="right-next" href="T1-3E3-Activity-Compuational_HOM.html" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">Activity 2 – Two-photon (HOM) interference simulation</p>
</div>
<i class="fa-solid fa-angle-right"></i>
</a>
</div>
</footer>
</div>
<dialog id="pst-secondary-sidebar-modal"></dialog>
<div class="bd-sidebar-secondary bd-toc" id="pst-secondary-sidebar"><div class="sidebar-secondary-items sidebar-secondary__inner">
<div class="sidebar-secondary-item">
<div class="page-toc tocsection onthispage">
<i class="fa-solid fa-list"></i> Contents
  </div>
<nav class="bd-toc-nav page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prelab">Prelab</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cavity-coupled-quantum-electrodynamic-qed-sensor">Cavity-coupled quantum electrodynamic (QED) sensor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#linear-regime">Linear Regime</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nonlinear-regime">Nonlinear Regime</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimum-detectable-magnetic-field">Minimum detectable magnetic field</a></li>
</ul>
</nav></div>
</div></div>
</div>
<footer class="bd-footer-content">
<div class="bd-footer-content__inner container">
<div class="footer-item">
<p class="component-author">
By Dirk Englund, Donnie Keathley, Jane Heyes, Kevin Chen
</p>
</div>
<div class="footer-item">
<p class="copyright">
    
      © Copyright 2023.
      <br/>
</p>
</div>
<div class="footer-item">
</div>
<div class="footer-item">
</div>
</div>
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script defer="" src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer="" src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>
<footer class="bd-footer">
</footer>
<script src="../_static/scripts/chattutor.config.js"></script><script src="../_static/scripts/chattutor.min.js"></script></body>
</html>