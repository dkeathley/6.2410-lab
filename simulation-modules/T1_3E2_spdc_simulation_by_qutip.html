
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Activity 1: SPDC Simulation by QuTip &#8212; 6.2410 -- Laboratory for Quantum Information Science and Engineering</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"ket": ["\\left|{#1}\\right\\rangle", 1], "bra": ["\\left\\langle{#1}\\right|", 1], "braket": ["\\left\\langle{#1}\\middle|{#2}\\right\\rangle", 2], "adagger": ["\\hat{a}^{\\dagger}"], "ahat": ["\\hat{a}"], "bdagger": ["\\hat{b}^{\\dagger}"], "bhat": ["\\hat{b}"], "cdagger": ["\\hat{c}^{\\dagger}"], "chat": ["\\hat{c}"], "ddagger": ["\\hat{d}^{\\dagger}"], "dhat": ["\\hat{d}"], "edagger": ["\\hat{e}^{\\dagger}"], "ehat": ["\\hat{e}"], "fdagger": ["\\hat{f}^{\\dagger}"], "fhat": ["\\hat{f}"], "gdagger": ["\\hat{g}^{\\dagger}"], "ghat": ["\\hat{g}"], "hdagger": ["\\hat{h}^{\\dagger}"], "hhat": ["\\hat{h}"], "gtwo": ["g^{(2)}"], "H": ["\\ket{H}"], "V": ["\\ket{V}"], "D": ["\\ket{D}"], "AD": ["\\ket{AD}"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"0b3837d30be34c2fb14315b2804e1f13": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "132c731c29ea48ae92dd3e1ab1ed746f": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "1a1387fd1bfb4eec8cce5d4faffd4f86": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "IntSliderModel", "state": {"behavior": "drag-tap", "continuous_update": false, "description": "Time index:", "layout": "IPY_MODEL_d6a17f1db2414c4abce47b7637233725", "max": 1000, "style": "IPY_MODEL_87fef42aa065458aab1e496b17c33af1", "value": 500}}, "1bc5a313cfbf47dc80c1cac4a8fccd56": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"layout": "IPY_MODEL_e5f32fbeef124ce7b8cb52f0862842f2", "outputs": [{"ename": "TypeError", "evalue": "'numpy.float64' object cannot be interpreted as an integer", "output_type": "error", "traceback": ["\u001b[31m---------------------------------------------------------------------------\u001b[39m", "\u001b[31mTypeError\u001b[39m                                 Traceback (most recent call last)", "\u001b[36mFile \u001b[39m\u001b[32m~/.local/lib/python3.13/site-packages/ipywidgets/widgets/interaction.py:243\u001b[39m, in \u001b[36minteractive.update\u001b[39m\u001b[34m(self, *args)\u001b[39m\n\u001b[32m    241\u001b[39m     value = widget.get_interact_value()\n\u001b[32m    242\u001b[39m     \u001b[38;5;28mself\u001b[39m.kwargs[widget._kwarg] = value\n\u001b[32m--> \u001b[39m\u001b[32m243\u001b[39m \u001b[38;5;28mself\u001b[39m.result = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mf\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    244\u001b[39m show_inline_matplotlib_plots()\n\u001b[32m    245\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m.auto_display \u001b[38;5;129;01mand\u001b[39;00m \u001b[38;5;28mself\u001b[39m.result \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n", "\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[4]\u001b[39m\u001b[32m, line 13\u001b[39m, in \u001b[36mupdate_plot\u001b[39m\u001b[34m(t)\u001b[39m\n\u001b[32m     11\u001b[39m     bar_vals_b = real(psib.diag())\n\u001b[32m     12\u001b[39m \u001b[38;5;66;03m#    max_val = max(bar_vals_a.max(), bar_vals_b.max())\u001b[39;00m\n\u001b[32m---> \u001b[39m\u001b[32m13\u001b[39m     max_val = \u001b[38;5;28;43mmax\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43mbar_vals_a\u001b[49m\u001b[43m[\u001b[49m\u001b[32;43m1\u001b[39;49m\u001b[43m:\u001b[49m\u001b[43m]\u001b[49m\u001b[43m.\u001b[49m\u001b[43mmax\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mbar_vals_b\u001b[49m\u001b[43m[\u001b[49m\u001b[32;43m1\u001b[39;49m\u001b[43m:\u001b[49m\u001b[43m]\u001b[49m\u001b[43m.\u001b[49m\u001b[43mmax\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m \u001b[38;5;66;03m# ignore first entry P(0) which is always going to be large\u001b[39;00m\n\u001b[32m     14\u001b[39m     axes[\u001b[32m0\u001b[39m].bar(\u001b[38;5;28mrange\u001b[39m(N1), bar_vals_a)\n\u001b[32m     15\u001b[39m     axes[\u001b[32m1\u001b[39m].bar(\u001b[38;5;28mrange\u001b[39m(N2), bar_vals_b)\n", "\u001b[36mFile \u001b[39m\u001b[32m/usr/lib64/python3.13/site-packages/numpy/_core/fromnumeric.py:3164\u001b[39m, in \u001b[36mmax\u001b[39m\u001b[34m(a, axis, out, keepdims, initial, where)\u001b[39m\n\u001b[32m   3052\u001b[39m \u001b[38;5;129m@array_function_dispatch\u001b[39m(_max_dispatcher)\n\u001b[32m   3053\u001b[39m \u001b[38;5;129m@set_module\u001b[39m(\u001b[33m'\u001b[39m\u001b[33mnumpy\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m   3054\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[34mmax\u001b[39m(a, axis=\u001b[38;5;28;01mNone\u001b[39;00m, out=\u001b[38;5;28;01mNone\u001b[39;00m, keepdims=np._NoValue, initial=np._NoValue,\n\u001b[32m   3055\u001b[39m          where=np._NoValue):\n\u001b[32m   3056\u001b[39m \u001b[38;5;250m    \u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m   3057\u001b[39m \u001b[33;03m    Return the maximum of an array or maximum along an axis.\u001b[39;00m\n\u001b[32m   3058\u001b[39m \n\u001b[32m   (...)\u001b[39m\u001b[32m   3162\u001b[39m \u001b[33;03m    5\u001b[39;00m\n\u001b[32m   3163\u001b[39m \u001b[33;03m    \"\"\"\u001b[39;00m\n\u001b[32m-> \u001b[39m\u001b[32m3164\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43m_wrapreduction\u001b[49m\u001b[43m(\u001b[49m\u001b[43ma\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mnp\u001b[49m\u001b[43m.\u001b[49m\u001b[43mmaximum\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[33;43m'\u001b[39;49m\u001b[33;43mmax\u001b[39;49m\u001b[33;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43maxis\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mNone\u001b[39;49;00m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mout\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m   3165\u001b[39m \u001b[43m                          \u001b[49m\u001b[43mkeepdims\u001b[49m\u001b[43m=\u001b[49m\u001b[43mkeepdims\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43minitial\u001b[49m\u001b[43m=\u001b[49m\u001b[43minitial\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mwhere\u001b[49m\u001b[43m=\u001b[49m\u001b[43mwhere\u001b[49m\u001b[43m)\u001b[49m\n", "\u001b[36mFile \u001b[39m\u001b[32m/usr/lib64/python3.13/site-packages/numpy/_core/fromnumeric.py:84\u001b[39m, in \u001b[36m_wrapreduction\u001b[39m\u001b[34m(obj, ufunc, method, axis, dtype, out, **kwargs)\u001b[39m\n\u001b[32m     82\u001b[39m             \u001b[38;5;28;01mreturn\u001b[39;00m reduction(axis=axis, dtype=dtype, out=out, **passkwargs)\n\u001b[32m     83\u001b[39m         \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[32m---> \u001b[39m\u001b[32m84\u001b[39m             \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mreduction\u001b[49m\u001b[43m(\u001b[49m\u001b[43maxis\u001b[49m\u001b[43m=\u001b[49m\u001b[43maxis\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mout\u001b[49m\u001b[43m=\u001b[49m\u001b[43mout\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mpasskwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     86\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m ufunc.reduce(obj, axis, dtype, out, **passkwargs)\n", "\u001b[36mFile \u001b[39m\u001b[32m/usr/lib64/python3.13/site-packages/numpy/_core/_methods.py:44\u001b[39m, in \u001b[36m_amax\u001b[39m\u001b[34m(a, axis, out, keepdims, initial, where)\u001b[39m\n\u001b[32m     42\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[34m_amax\u001b[39m(a, axis=\u001b[38;5;28;01mNone\u001b[39;00m, out=\u001b[38;5;28;01mNone\u001b[39;00m, keepdims=\u001b[38;5;28;01mFalse\u001b[39;00m,\n\u001b[32m     43\u001b[39m           initial=_NoValue, where=\u001b[38;5;28;01mTrue\u001b[39;00m):\n\u001b[32m---> \u001b[39m\u001b[32m44\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mumr_maximum\u001b[49m\u001b[43m(\u001b[49m\u001b[43ma\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43maxis\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mNone\u001b[39;49;00m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mout\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mkeepdims\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43minitial\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mwhere\u001b[49m\u001b[43m)\u001b[49m\n", "\u001b[31mTypeError\u001b[39m: 'numpy.float64' object cannot be interpreted as an integer"]}]}}, "1f80faec89b04866b657c6d2fedbb170": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "SliderStyleModel", "state": {"description_width": ""}}, "256fa074448d43949b1834f8fe40607e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "VBoxModel", "state": {"_dom_classes": ["widget-interact"], "children": ["IPY_MODEL_1a1387fd1bfb4eec8cce5d4faffd4f86", "IPY_MODEL_1bc5a313cfbf47dc80c1cac4a8fccd56"], "layout": "IPY_MODEL_0b3837d30be34c2fb14315b2804e1f13"}}, "2953798ce9ec4586ab029c61197b866e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "IntSliderModel", "state": {"behavior": "drag-tap", "continuous_update": false, "description": "Time index:", "layout": "IPY_MODEL_c26c8d1a3a80450c9522620ce998882a", "max": 1000, "style": "IPY_MODEL_67af4b1558c64ae8ab67256175bddc37", "value": 500}}, "358a7753975340b187329441318cddcd": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "5614052f5937444a8f4907c314cbc367": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "VBoxModel", "state": {"_dom_classes": ["widget-interact"], "children": ["IPY_MODEL_dfd2d093e5e64ae8966eaa410646ac21", "IPY_MODEL_abf7111cfa6c421a9aad9b6b90683b2e"], "layout": "IPY_MODEL_e94975239fb4427db6599f45e8b1f7fc"}}, "570a6b1293114bec9e8620d3c6b71d95": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "67af4b1558c64ae8ab67256175bddc37": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "SliderStyleModel", "state": {"description_width": ""}}, "82a9d21fdd684c0cb6b4f0406523307a": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "87fef42aa065458aab1e496b17c33af1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "SliderStyleModel", "state": {"description_width": ""}}, "9c037213100d4405814b176dd2ea0c56": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "VBoxModel", "state": {"_dom_classes": ["widget-interact"], "children": ["IPY_MODEL_2953798ce9ec4586ab029c61197b866e", "IPY_MODEL_fb3201e0ec7e4def85bc429f684da6a9"], "layout": "IPY_MODEL_132c731c29ea48ae92dd3e1ab1ed746f"}}, "a0f39a2efd36483088ea7db71c31eff6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "SliderStyleModel", "state": {"description_width": ""}}, "abf7111cfa6c421a9aad9b6b90683b2e": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"layout": "IPY_MODEL_570a6b1293114bec9e8620d3c6b71d95"}}, "b3faf7695a9f4bf5adfaf5c68b09dae5": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "c26c8d1a3a80450c9522620ce998882a": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "ccabe09c084b40a9aaa5e4daf8cd248b": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"layout": "IPY_MODEL_d4270659831242a78d32867a9872dfb1"}}, "d4270659831242a78d32867a9872dfb1": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "d6a17f1db2414c4abce47b7637233725": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "dfd2d093e5e64ae8966eaa410646ac21": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "IntSliderModel", "state": {"behavior": "drag-tap", "continuous_update": false, "description": "Time index:", "layout": "IPY_MODEL_f230903a330345f79c7b0bfe53b49272", "max": 1000, "style": "IPY_MODEL_a0f39a2efd36483088ea7db71c31eff6", "value": 500}}, "e5f32fbeef124ce7b8cb52f0862842f2": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "e94975239fb4427db6599f45e8b1f7fc": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "f230903a330345f79c7b0bfe53b49272": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {}}, "f5f63229cca64cb3a0b7727510567665": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "VBoxModel", "state": {"_dom_classes": ["widget-interact"], "children": ["IPY_MODEL_f6961029437f40448cfe39e47e9e0dd9", "IPY_MODEL_ccabe09c084b40a9aaa5e4daf8cd248b"], "layout": "IPY_MODEL_82a9d21fdd684c0cb6b4f0406523307a"}}, "f6961029437f40448cfe39e47e9e0dd9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "IntSliderModel", "state": {"behavior": "drag-tap", "continuous_update": false, "description": "Time index:", "layout": "IPY_MODEL_358a7753975340b187329441318cddcd", "max": 1000, "style": "IPY_MODEL_1f80faec89b04866b657c6d2fedbb170", "value": 500}}, "fb3201e0ec7e4def85bc429f684da6a9": {"model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "model_name": "OutputModel", "state": {"layout": "IPY_MODEL_b3faf7695a9f4bf5adfaf5c68b09dae5"}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'simulation-modules/T1_3E2_spdc_simulation_by_qutip';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Activity 2: Solid State Spis – Cavity QED Digital Twin" href="T1-3E3-Activity-Cavity_QED_sensor.html" />
    <link rel="prev" title="LAB – Quantum Sensing With Solid State Spins (Week 2)" href="../quNV-Jupyter/T3E3-LAB-Week2-Quantum-Sensing-with-Solid-State-Spins.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo-ibm.jpg" class="logo__image only-light" alt="6.2410 -- Laboratory for Quantum Information Science and Engineering - Home"/>
    <script>document.write(`<img src="../_static/logo-ibm.jpg" class="logo__image only-dark" alt="6.2410 -- Laboratory for Quantum Information Science and Engineering - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    6.2410 – Laboratory in Quantum Systems Engineering: Quantum Engineering Platforms
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introductory Material</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../BASICS-quantum-optics-basics.html">BASICS – Quantum Optics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">T3E1 -- Interference, Entanglement, Quantum-Enhanced Sensing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../T3E1-TEXT--entanglement-interference-quantum-enhanced-sensing.html">TEXT – Interference, Entanglement and Quantum-Enhanced Metrology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../T3E1-LAB--entanglement-interference-quantum-enhanced-sensing.html">LAB – Interference, Entanglement and Quantum-Enhanced Metrology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../T3E1-EXTRAS-interference-2-homodyne-detection.html">EXTRAS – Homodyne Detection</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">T2E1 -- Quantum Information and Quantum Key Distribution</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../T2E1-TEXT-HBT.html">TEXT - Introduction to single photons with the quED (Week 1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../T2E1-LAB-HBT.html">LAB – Hanbury Brown - Twiss Lab (Week 1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../T2E1-TEXT-QKD.html">TEXT – QKD (Week 2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../T2E1-LAB-BB84.html">LAB – QKD (Week 2)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">T3E3 -- Solid State Spins</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../quNV-Jupyter/T3E3-PARKOUR-Quantum-Sensing-with-Solid-State-Spins.html">TRAINING - Interfacing with the Vector Network Analyzer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quNV-Jupyter/T3E3-TEXT-Quantum-Sensing-with-Solid-State-Spins.html">TEXT: Introduction to NV centers in diamond and cavity-based magnetometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quNV-Jupyter/T3E3-LAB-Week1-Quantum-Sensing-with-Solid-State-Spins.html">LAB - Quantum Sensing with Solid State Spins (Week 1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quNV-Jupyter/T3E3-LAB-Week2-Quantum-Sensing-with-Solid-State-Spins.html">LAB – Quantum Sensing With Solid State Spins (Week 2)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">T1:3E2 -- Quantum Simulation Lab</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Activity 1: SPDC Simulation by QuTip</a></li>
<li class="toctree-l1"><a class="reference internal" href="T1-3E3-Activity-Cavity_QED_sensor.html">Activity 2: Solid State Spis – Cavity QED Digital Twin</a></li>
<li class="toctree-l1"><a class="reference internal" href="T1-3E3-Activity-Compuational_HOM.html">Activity 3: Two-photon (HOM) interference simulation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Final Projects</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../FINAL-PROJECTS.html">Final Design Project</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Templates</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../TEMPLATES/TEMPLATE-6.2410-summary-report.html">Summary Report Template</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/dkeathley/S23-6.2410-lab/main?urlpath=tree/simulation-modules/T1_3E2_spdc_simulation_by_qutip.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/dkeathley/S23-6.2410-lab/blob/main/simulation-modules/T1_3E2_spdc_simulation_by_qutip.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/dkeathley/S23-6.2410-lab" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/dkeathley/S23-6.2410-lab/issues/new?title=Issue%20on%20page%20%2Fsimulation-modules/T1_3E2_spdc_simulation_by_qutip.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/simulation-modules/T1_3E2_spdc_simulation_by_qutip.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Activity 1: SPDC Simulation by QuTip</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prelab-exercise-pt-1">Prelab Exercise Pt. 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports-and-headers">Imports and Headers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operators-and-hamiltonian">Operators and Hamiltonian</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prelab-exercises">Prelab Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulate-time-dependent-problem-in-qutip">Simulate Time-Dependent Problem in QuTiP</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-state-and-state-evolution">Initial state and state evolution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#state-evolution">State evolution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#second-order-coherence">Second-order coherence</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-degenerate-spdc-and-squeezing">Bonus: Degenerate SPDC and Squeezing</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="activity-1-spdc-simulation-by-qutip">
<h1>Activity 1: SPDC Simulation by QuTip<a class="headerlink" href="#activity-1-spdc-simulation-by-qutip" title="Link to this heading">#</a></h1>
<p>Quantum optics relies on a reliable source of single photons and entangled photon pairs.  A typical source of these photons is spontaneous parametric down-conversion (SPDC) within a nonlinear crystal.  For example, all of the quantum optics experimental lab modules in this class rely on SPDC.</p>
<p>In this activity, we will simulate the SPDC process and the quantum states of light it generates.  We will do this through the formalism of the degenerate parametric amplifier.</p>
<p>Specific aims of this activity are:</p>
<ul class="simple">
<li><p>Enrich your understanding of the SPDC process.</p></li>
<li><p>Develop a realistic model of an SPDC source that could be further extended and used in the context of device and technology simulation and design.</p></li>
</ul>
<section id="prelab-exercise-pt-1">
<h2>Prelab Exercise Pt. 1<a class="headerlink" href="#prelab-exercise-pt-1" title="Link to this heading">#</a></h2>
<p>0a. Setup <a class="reference external" href="https://qutip.org/">QuTiP</a> to run on a cloud service like Google Colab or install it on your own PC.</p>
<p>0b. Go through and perform the activities in <a class="reference external" href="https://qutip.org/qutip-tutorials/">QuTiP Lecture 0</a>.</p>
<p>For these parts, you can submit a Jupyter notebook and pdf export showing you went through and performed the activities.</p>
</section>
<section id="imports-and-headers">
<h2>Imports and Headers<a class="headerlink" href="#imports-and-headers" title="Link to this heading">#</a></h2>
<p>Install qutip if needed and import tools for the simulations performed throughout this activity.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Install qutip</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>qutip

<span class="c1">#Import qutip functions</span>
<span class="kn">from</span> <span class="nn">qutip</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1">#Matplotlib tools for plotting</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>

<span class="c1">#Numpy for numerics</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: qutip in /home/dkeathley/.local/lib/python3.13/site-packages (5.2.3)
Requirement already satisfied: numpy&gt;=1.22 in /usr/lib64/python3.13/site-packages (from qutip) (2.2.6)
Requirement already satisfied: scipy!=1.16.0,!=1.17.0,&gt;=1.9 in /home/dkeathley/.local/lib/python3.13/site-packages (from qutip) (1.16.3)
Requirement already satisfied: packaging in /usr/lib/python3.13/site-packages (from qutip) (24.2)
</pre></div>
</div>
</div>
</details>
</div>
<section id="operators-and-hamiltonian">
<span id="content-t1-3-e2-spdc"></span><h3>Operators and Hamiltonian<a class="headerlink" href="#operators-and-hamiltonian" title="Link to this heading">#</a></h3>
<p>If you have not read it yet, please read the introduction to how SPDC is physically generated in the <a class="reference internal" href="../T2E1-TEXT-HBT.html#content-t2e1-intro-single-photons"><span class="std std-ref">text</span></a> for the T2E1 lab module.</p>
<p>The SPDC process works by driving a nonlinear crystal with strong light at a pump frequency <span class="math notranslate nohighlight">\(\omega_p\)</span>.  One photon of the pump light is then spontaneously converted into two photons <span class="math notranslate nohighlight">\(\omega_s\)</span> and <span class="math notranslate nohighlight">\(\omega_i\)</span>, which refer to the signal and idler modes respectively.  This naming convention was developed to describe parametric amplfiers where one wanted to amplify a weak signal using a strong pump.  Energy conservation requires that this also corresponds with the growth of an idler wave, and you have that <span class="math notranslate nohighlight">\(\omega_p = \omega_s + \omega_i\)</span>.  In the SPDC process we are concerned with the spontaneous generation of the signal and idler.  These occupy modes as <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> respectively.</p>
<p>The parametric amplification occurs due to a nonlinear coupling between the fields of the pump, signal, and idler waves.  The coefficient describing the strength of this coupling is the nonlinear coefficient <span class="math notranslate nohighlight">\(\chi_2\)</span>, which is in general complex, but given freedom in choice of phase, we take it as a positive real number here.</p>
<p>The coupling Hamiltonian for the SPDC process can be represented as</p>
<div class="math notranslate nohighlight">
\[
\hat{H} = i\hbar( \chi_2 \hat{p} \hat{a}^\dagger \hat{b}^\dagger - \chi_2 \hat{p}^\dagger \hat{a} \hat{b})\mbox{,}
\]</div>
<p>where <span class="math notranslate nohighlight">\(p\)</span> represents the pump mode.  The left part describes the loss of one pump photon resulting in the increase of one photon in modes <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> (the signal and idler).  The right part represents back conversion from signal and idler to a pump photon.</p>
<p>Given a strong coherent state pump, we can represent its operator with a complex number <span class="math notranslate nohighlight">\(\alpha_p\)</span> corresponding to its amplitude.  Doing this  we have the Hamiltonian we want to solve for this exercise as</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
\hat{H}_{ab} = i \hbar \frac{\chi}{2} (\hat{a}^{\dagger} \hat{b}^{\dagger} - \hat{a} \hat{b})
\end{aligned}
\]</div>
<p>where we define</p>
<div class="math notranslate nohighlight">
\[
\chi \equiv 2 \chi_2 |\alpha_p|.
\]</div>
<p>Note that we use the liberty of setting the pump phase arbitrarily, and define it by the amplitude <span class="math notranslate nohighlight">\(|\alpha_p|\)</span>.</p>
</section>
</section>
<section id="prelab-exercises">
<h2>Prelab Exercises<a class="headerlink" href="#prelab-exercises" title="Link to this heading">#</a></h2>
<p>0c. Show that <span class="math notranslate nohighlight">\(\frac{d\hat{a}}{dt} = \frac{\chi}{2}\hat{b}^{\dagger}\)</span>, and  <span class="math notranslate nohighlight">\(\frac{d\hat{b}^{\dagger}}{dt} = \frac{\chi}{2}\hat{a}\)</span>. (Hint: use the fact that <span class="math notranslate nohighlight">\(\frac{d\hat{a}}{dt} = \frac{i}{\hbar}[\hat{H}, \hat{a}]\)</span> for any operator <span class="math notranslate nohighlight">\(\hat{a}\)</span>).</p>
<p>Note: this is the Heisenberg picture where we evolve the operators instead of the state. See <a class="reference external" href="https://en.wikipedia.org/wiki/Heisenberg_picture">https://en.wikipedia.org/wiki/Heisenberg_picture</a>.</p>
<p>0d.  The above coupled differential equation has the solutions <span class="math notranslate nohighlight">\(\hat{a}(T) = \cosh (\chi T/2) \hat{a}(0) + \sinh(\chi T/2) \hat{b}^\dagger (0)\)</span> and <span class="math notranslate nohighlight">\(\hat{b}^\dagger(T) = \sinh (\chi T/2) \hat{a}(0) + \cosh(\chi T/2) \hat{b}^\dagger (0)\)</span> at time <span class="math notranslate nohighlight">\(T\)</span> given the initial operators at time <span class="math notranslate nohighlight">\(0\)</span>. Derive the output photon number in <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> at a time <span class="math notranslate nohighlight">\(T\)</span>.  (Hints: Start with the vacuum state and apply the number operator; you should get something with <span class="math notranslate nohighlight">\(\sinh^2\)</span>).</p>
</section>
<section id="simulate-time-dependent-problem-in-qutip">
<h2>Simulate Time-Dependent Problem in QuTiP<a class="headerlink" href="#simulate-time-dependent-problem-in-qutip" title="Link to this heading">#</a></h2>
<p>In the following code we define the needed creation and annihilation operators as well as the Hamiltonian of the system to solve.  The <code class="docutils literal notranslate"><span class="pre">tensor()</span></code> function is used to create composite operators that act on the joint Hilbert space of the two modes <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>. The <code class="docutils literal notranslate"><span class="pre">destroy()</span></code> and <code class="docutils literal notranslate"><span class="pre">num()</span></code> functions create the annihilation and number operators, respectively.</p>
<p>Note that a difference between the following code and the equations above is that we factor out the <span class="math notranslate nohighlight">\(\hbar\)</span> term from the Hamiltonian.  By default, the unit of time in Qutip is set to be dimensionless, so <span class="math notranslate nohighlight">\(\hbar\)</span> is used to convert between dimensionless time and physical time.  In other words, the units in QuTiP are such that <span class="math notranslate nohighlight">\(\hbar = 1\)</span>.</p>
<p>For the coupling term <span class="math notranslate nohighlight">\(\chi\)</span> we have selected a value that, in combination with the phase-matching bandwidth (provided below), results in a photon generation rate similar to what you see in the lab experiments. This will be described further in Exercise 1 where you calculate the photon pair generation rate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constants</span>
<span class="n">hbar</span><span class="o">=</span><span class="mf">6.67e-34</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span> <span class="c1">#Planck&#39;s reduced constant</span>
<span class="n">eps0</span><span class="o">=</span><span class="mf">8.85e-12</span> <span class="c1"># permittivity of free space</span>
<span class="n">c</span><span class="o">=</span><span class="mf">2.99792458e8</span> <span class="c1"># speed of light</span>

<span class="c1"># User Parameters</span>
<span class="n">phase_matching_bandwidth</span><span class="o">=</span><span class="mf">1e13</span> <span class="c1"># approximate in Hz (you can make this consisten with experimental measurement)</span>
<span class="n">chi</span><span class="o">=</span><span class="mf">1e-6</span> <span class="c1"># defines strength of nonlinearity, driven by peak pump field strength and chi2</span>
<span class="n">N1</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># number of photon orders in Fock state basis for a</span>
<span class="n">N2</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># number of photon orders in Fock state basis for b</span>

<span class="c1"># Presentation parameters</span>
<span class="n">plot_fontsize</span><span class="o">=</span><span class="mi">12</span>

<span class="c1"># Definitions of operators</span>
<span class="c1"># -- we define the operators through tensor products...</span>
<span class="c1"># -- two quantum objects per tensor product as we have</span>
<span class="c1"># -- two modes we are simulating here, a and b</span>
<span class="n">a</span>  <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">destroy</span><span class="p">(</span><span class="n">N1</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="n">N2</span><span class="p">))</span>
<span class="n">na</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">num</span><span class="p">(</span><span class="n">N1</span><span class="p">),</span>     <span class="n">qeye</span><span class="p">(</span><span class="n">N2</span><span class="p">))</span>
<span class="n">b</span>  <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">qeye</span><span class="p">(</span><span class="n">N1</span><span class="p">),</span>    <span class="n">destroy</span><span class="p">(</span><span class="n">N2</span><span class="p">))</span>
<span class="n">nb</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">qeye</span><span class="p">(</span><span class="n">N1</span><span class="p">),</span>    <span class="n">num</span><span class="p">(</span><span class="n">N2</span><span class="p">))</span>

<span class="c1"># Now we define the coupling Hamiltonian as in the text above:</span>
<span class="n">H0</span> <span class="o">=</span> <span class="mi">0</span><span class="o">*</span><span class="n">a</span> <span class="c1"># interaction Hamiltonian before the 3-wave mixing (used for calculating initial state)</span>
<span class="n">Hab</span> <span class="o">=</span>  <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">chi</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="initial-state-and-state-evolution">
<h2>Initial state and state evolution<a class="headerlink" href="#initial-state-and-state-evolution" title="Link to this heading">#</a></h2>
<p>In the following, we initialize/define:</p>
<ul class="simple">
<li><p>input state <span class="math notranslate nohighlight">\(\ket{\psi_0}\)</span> of modes a and b, which are both in the vacuum state</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tlist</span></code>: a list of times that specifies the times at which the system should be evaluated during the evolution. In the example, tlist is created using the numpy function linspace, which generates an array of evenly spaced values over a specified interval.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c_ops</span></code>: a list of collapse operators that describe the sources of decoherence and dissipation in the system. Collapse operators represent the interactions of the system with its environment that cause transitions between the energy eigenstates of the system.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">e_ops</span></code>: a python list storing observables. Here, the e_ops list is empty, which means that there are no observables being monitored during the evolution of the system.</p></li>
</ul>
<p>We then use the function mesolve from the Qutip library to solve the <a class="reference external" href="https://https://en.wikipedia.org/wiki/Quantum_master_equation">quantum master equation </a> to find the time evolution of the system. The function takes as input the Hamiltonian <code class="docutils literal notranslate"><span class="pre">Hab</span></code>, the initial state <code class="docutils literal notranslate"><span class="pre">psi0</span></code>, the list of times <code class="docutils literal notranslate"><span class="pre">tlist</span></code>, the list of collapse operators <code class="docutils literal notranslate"><span class="pre">c_ops</span></code>, and the list of observables <code class="docutils literal notranslate"><span class="pre">e_ops</span></code>. The function returns an object output that contains information about the time evolution of the system, such as the states of the system at each time in <code class="docutils literal notranslate"><span class="pre">tlist</span></code>.</p>
<p>In the example, the <code class="docutils literal notranslate"><span class="pre">c_ops</span></code> list is empty, which means that there are no sources of decoherence or dissipation in the system. As a result, the evolution of the system is purely unitary and described by the Hamiltonian <span class="math notranslate nohighlight">\(H_{ab}\)</span>.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># System Definition:</span>

<span class="c1"># Initial State</span>
<span class="c1"># -- start in the ground (vacuum) state</span>
<span class="n">psi0</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">basis</span><span class="p">(</span><span class="n">N1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">basis</span><span class="p">(</span><span class="n">N2</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="c1"># initial state in the vacuum: |0&gt;|0&gt;</span>

<span class="n">c_ops</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># c_ops is a list of collapse operators that describe the sources of</span>
            <span class="c1"># decoherence and dissipation in the system. Collapse operators represent</span>
            <span class="c1"># the interactions of the system with its environment that cause</span>
            <span class="c1"># transitions between the energy eigenstates of the system.</span>

<span class="n">tlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1001</span><span class="p">)</span> <span class="c1"># tlist is a list of times that specifies the</span>
                                   <span class="c1"># times at which the system should be evaluated</span>
                                   <span class="c1"># during the evolution. In the example, tlist</span>
                                   <span class="c1"># is created using the numpy function linspace,</span>
                                   <span class="c1"># which generates an array of evenly spaced</span>
                                   <span class="c1"># values over a specified interval.</span>

<span class="n">e_ops</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># e_ops is a python list storing observables. Here, the e_ops list is</span>
           <span class="c1"># empty, which means that there are no observables being monitored</span>
           <span class="c1"># during the evolution of the system</span>

<span class="c1"># -- Solve Quantum Master Equation --</span>
<span class="n">psi_out</span> <span class="o">=</span> <span class="n">mesolve</span><span class="p">(</span><span class="n">Hab</span><span class="p">,</span> <span class="n">psi0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">c_ops</span><span class="p">,</span> <span class="n">e_ops</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="admonition hide below-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell output</p>
<p class="expanded admonition-title">Hide code cell output</p>
</summary>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/dkeathley/.local/lib/python3.13/site-packages/qutip/solver/solver_base.py:598: FutureWarning: e_ops will be keyword only from qutip 5.3 for all solver
  warnings.warn(
</pre></div>
</div>
</div>
</details>
</div>
<section id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Link to this heading">#</a></h3>
<p>1a. Verify the Hermiticity of the Hamiltonian.</p>
<p>1b. Define operator objects for the number operators <span class="math notranslate nohighlight">\(\hat{N}\)</span> in <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>, as well as the operator for <span class="math notranslate nohighlight">\(\hat{N}^2\)</span> for <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>.</p>
<p>1c. Use the <code class="docutils literal notranslate"><span class="pre">expect()</span></code> function to evaluate the expectation of the photon number in <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> for all of the output states, provided by <code class="docutils literal notranslate"><span class="pre">phi_out.states</span></code>.  You should have <code class="docutils literal notranslate"><span class="pre">1000</span></code> output states, one for each point in time in <code class="docutils literal notranslate"><span class="pre">tlist</span></code>.  Plot the growth of the photon number as a function of time.  Does it makes sense? (Compare directly to your expected expression from the pre-lab by plotting that result on top of the result simulated with QuTip).</p>
<p>The code block below gets you started.  If needed, a refresher on photon number operators and photon number statistics is provided in <a class="reference internal" href="../BASICS-quantum-optics-basics.html#content-basics-quantum-optics"><span class="std std-ref">BASICS – Quantum Optics</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">na</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span><span class="o">*</span><span class="n">a</span> <span class="c1">#number operator for mod a</span>
<span class="n">e_na</span> <span class="o">=</span> <span class="n">expect</span><span class="p">(</span><span class="n">na</span><span class="p">,</span> <span class="n">psi_out</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

<span class="c1">#... your code here to finish the exercise ...</span>
</pre></div>
</div>
</div>
</div>
<p>1d. Now calculate the standard deviation of the photon number in <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>.  Explain the nature of the growth of the standard deviation.  Does it also match theory?  Explain why this growth behavior make sense.</p>
<p>1e. The photon rate (output photons per second) can be expressed as the phase-matching bandwidth times the photon number.  Given the maximum value at the final time in the interaction, what is the photon emission rate?  How does this compare to the incident pump photon rate assuming a pump wavelength of 400 nm and power of 10 mW?</p>
</section>
</section>
<section id="state-evolution">
<h2>State evolution<a class="headerlink" href="#state-evolution" title="Link to this heading">#</a></h2>
<p>Next, we will plot the photon distributions of two quantum optical modes a and b at selected times.</p>
<p>The time indices are spaced over the number of time steps in <code class="docutils literal notranslate"><span class="pre">tlist</span></code>.</p>
<p>The following subplots show the state evolution (note the plots have shared horizontal and vertical axes). We represent the photon distributions as bar plots on the subplots.</p>
<p>Only single-photon pairs in <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are generated at a non-neglibile rate (but are still far fewer than the number of incident pump photons), with neglible amounts of higher order Fock state generation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>

<span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">5</span>

<span class="k">def</span> <span class="nf">update_plot</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">psia</span> <span class="o">=</span> <span class="n">ptrace</span><span class="p">(</span><span class="n">psi_out</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">psib</span> <span class="o">=</span> <span class="n">ptrace</span><span class="p">(</span><span class="n">psi_out</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">bar_vals_a</span> <span class="o">=</span> <span class="n">real</span><span class="p">(</span><span class="n">psia</span><span class="o">.</span><span class="n">diag</span><span class="p">())</span>
    <span class="n">bar_vals_b</span> <span class="o">=</span> <span class="n">real</span><span class="p">(</span><span class="n">psib</span><span class="o">.</span><span class="n">diag</span><span class="p">())</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N1</span><span class="p">),</span> <span class="n">bar_vals_a</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N2</span><span class="p">),</span> <span class="n">bar_vals_b</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$P(n)$&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$P(n)$&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$n_a$&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$n_b$&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">10</span><span class="o">**-</span><span class="mi">8</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">bar_vals_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1.2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">10</span><span class="o">**-</span><span class="mi">8</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">bar_vals_a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1.2</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">t_selector</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span>
    <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="nb">max</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">tlist</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Time index:&#39;</span><span class="p">,</span>
    <span class="n">continuous_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1">#display(t_selector)</span>
<span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">update_plot</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">t_selector</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f5f63229cca64cb3a0b7727510567665", "version_major": 2, "version_minor": 0}</script><img alt="../_images/758e067fee4ab9825597587529948023ab106001ea1cee7992ffc0a23ab029ea.png" src="../_images/758e067fee4ab9825597587529948023ab106001ea1cee7992ffc0a23ab029ea.png" />
</div>
</div>
<section id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Link to this heading">#</a></h3>
<p>2a. Increase the coupling term, <span class="math notranslate nohighlight">\(\chi\)</span> and redo the above state visualization.  What happens in terms of the photon number distribution when <span class="math notranslate nohighlight">\(\chi\)</span> becomes large?  Does the analytical solution still hold?</p>
<p>Hint: We assumed a constant number of pump photons.</p>
</section>
</section>
<section id="second-order-coherence">
<h2>Second-order coherence<a class="headerlink" href="#second-order-coherence" title="Link to this heading">#</a></h2>
<p>Here we examine the generated photon statistics further by looking at the second order correlation function of photons in the outgoing modes <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>. Note that second order coherence of single and heralded single-photons using SPDC is explored further in the <a class="reference internal" href="../T2E1-TEXT-HBT.html#content-t2e1-intro-single-photons"><span class="std std-ref">T2E1 lab</span></a> through the use of a HBT measurement.</p>
<p>Classical fields satisfy the Cauchy-Schwarz inequality evaluated at the same time <span class="math notranslate nohighlight">\(t\)</span> on both detectors (Walls and Milburn, page 79).  This can be expressed with respect to the second order correlation functions of the output state at time <span class="math notranslate nohighlight">\(t\)</span> as:</p>
<div class="math notranslate nohighlight">
\[(g^{(2)}_{ab})^2 \leq g^{(2)}_{aa} g^{(2)}_{bb}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[g^{(2)}_{ab} = \frac{\langle \hat{a}^\dagger \hat{a} \hat{b}^\dagger \hat{b} \rangle}{\langle \hat{a}^\dagger \hat{a} \rangle \langle \hat{b}^\dagger \hat{b}\rangle} \]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[g^{(2)}_{aa} = \frac{\langle \hat{a}^\dagger \hat{a}^\dagger \hat{a} \hat{a} \rangle}{\langle \hat{a}^\dagger \hat{a} \rangle ^2} \]</div>
<p>and likewise for <span class="math notranslate nohighlight">\(g^{(2)}_{bb}\)</span>.</p>
<p>In the following you will explore this inequality further.</p>
<section id="exercise-3">
<h3>Exercise 3<a class="headerlink" href="#exercise-3" title="Link to this heading">#</a></h3>
<p>3a. Using the same procedure as for the photon number expectation calculations, now calculate and plot the second order correlation functions for <span class="math notranslate nohighlight">\(g^{(2)}_{aa}\)</span>, <span class="math notranslate nohighlight">\(g^{(2)}_{bb}\)</span>, and <span class="math notranslate nohighlight">\(g^{(2)}_{ab}\)</span>.</p>
<p>3b. Is the Cauchy-Schwarz inequality broken?</p>
<p>3c. You should find that the photon correlations of the fields produced from a vacuum passing through the parametric amplifier are strongly nonclassical. It turns out they saturate the bound by quantum mechanics.</p>
<p>Hint: Think about <span class="math notranslate nohighlight">\(\langle \hat{a}^\dagger \hat{a} \hat{b}^\dagger \hat{b} \rangle\)</span> vs <span class="math notranslate nohighlight">\(\langle \hat{a}^\dagger \hat{a}\rangle\)</span> for the states that SPDC generates.</p>
<p>Discuss why this makes SPDC a valuable resource in the context of quantum technologies.</p>
</section>
</section>
<section id="bonus-degenerate-spdc-and-squeezing">
<h2>Bonus: Degenerate SPDC and Squeezing<a class="headerlink" href="#bonus-degenerate-spdc-and-squeezing" title="Link to this heading">#</a></h2>
<p>Two-photon states generated by degenerate SPDC sources (<em>i.e.</em> SPDC sources where the signal and idler share a single output mode) exhibit squeezing (see <a class="reference internal" href="../BASICS-quantum-optics-basics.html#sec-quantum-optics-basics-squeezed-states"><span class="std std-ref">Squeezed States</span></a>).  In fact, similar processes to what you are modeling are used to generate bright squeezed light that is enabling ultra-precise interferometric measurements.  To see how squeezed states can be used to reduce the readout noise of an interferometer, see <a class="reference internal" href="../T3E1-EXTRAS-interference-2-homodyne-detection.html#content-t3e1-extras-homodyne-detection"><span class="std std-ref">EXTRAS – Homodyne Detection</span></a>.</p>
<p><strong>Ba.</strong> Implement a degenerate SPDC where both photons emitted into a single mode. This is decribed by the Hamiltonain</p>
<div class="math notranslate nohighlight">
\[\hat{H}_{aa} = i \hbar \frac{\chi}{2} (\hat{a}^{\dagger2} - \hat{a}^2)\]</div>
<p>Use the same settings as above for the non-degenerate SPDC generation (i.e. same <code class="docutils literal notranslate"><span class="pre">chi</span></code>, <code class="docutils literal notranslate"><span class="pre">tlist</span></code>, etc).</p>
<p><strong>Bb.</strong> Calculate and visualize the Wigner function of the output state using QuTiP (<code class="docutils literal notranslate"><span class="pre">qutip.Wigner</span></code>).  The Wigner function helps visualize the field distribution of the outgoing state along the in-phase and quadrature planes.</p>
<p><strong>Bc.</strong> Now increase the nonlinearity setting <code class="docutils literal notranslate"><span class="pre">chi=5e-4</span></code>.  Plot the Wigner function again.  What is the difference? Do you see the halmarks of squeezing?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Wigner function example you can use:</span>

<span class="n">xvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">W_out</span> <span class="o">=</span> <span class="n">qutip</span><span class="o">.</span><span class="n">wigner</span><span class="p">(</span><span class="n">psi_out</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">W_out</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.contour.QuadContourSet at 0x7fa98a872660&gt;
</pre></div>
</div>
<img alt="../_images/c50e861e6ebed4f680245fad61447afcb1fb55c9b4383242e566feeff255421f.png" src="../_images/c50e861e6ebed4f680245fad61447afcb1fb55c9b4383242e566feeff255421f.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./simulation-modules"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../quNV-Jupyter/T3E3-LAB-Week2-Quantum-Sensing-with-Solid-State-Spins.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">LAB – Quantum Sensing With Solid State Spins (Week 2)</p>
      </div>
    </a>
    <a class="right-next"
       href="T1-3E3-Activity-Cavity_QED_sensor.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Activity 2: Solid State Spis – Cavity QED Digital Twin</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prelab-exercise-pt-1">Prelab Exercise Pt. 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports-and-headers">Imports and Headers</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operators-and-hamiltonian">Operators and Hamiltonian</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prelab-exercises">Prelab Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulate-time-dependent-problem-in-qutip">Simulate Time-Dependent Problem in QuTiP</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-state-and-state-evolution">Initial state and state evolution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#state-evolution">State evolution</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#second-order-coherence">Second-order coherence</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-degenerate-spdc-and-squeezing">Bonus: Degenerate SPDC and Squeezing</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dirk Englund, Donnie Keathley, Jane Heyes, Kevin Chen
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>